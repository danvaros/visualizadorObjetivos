<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Objetivos de Desarrollo Sostenible</title>
    <link rel="stylesheet" type="text/css" href="tooltipster/dist/css/tooltipster.bundle.min.css" />
	  <link rel="stylesheet" type="text/css" href="tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.css" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway:400,700,800,300,600italic,600" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.css" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="css/home.css">



	<!-- Load c3.css -->
	<link href="lib/c3.css" rel="stylesheet" type="text/css">
<style media="screen">
  .infoPadre{
    width: 276px;
}

  .cuadrosSocial li {
    display: inline;
}

.cuadrosSocial li a{
  border: 1px solid #ccc;
  padding: 10px;
  transition: all 1.0s ease;
  width: 40px;
}


.cuadrosSocial li a:hover {
  background-color: #ccc;

}

.select-dropdown{
  padding-left: 10px !important;
}


.select-wrapper span.caret{
  padding-right: 10px;
  font-size: 14px;
  color: #666;
}

.espacio_seccion{
  height: 40px;
}
</style>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="tooltipster/dist/js/tooltipster.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
    <script src="image.js"></script>
    <script type="text/javascript" src="http://gabelerner.github.io/canvg/rgbcolor.js"></script>
    <script type="text/javascript" src="http://gabelerner.github.io/canvg/StackBlur.js"></script>
    <script type="text/javascript" src="http://gabelerner.github.io/canvg/canvg.js"></script>  </head>
  <body>
    <div class="container">
      <div class="row" id="mapa">
          <div class="col s12">
            <div id="map"></div>
            <div class="row">
	            <div class="col s8 center-align">
	            	<a class="waves-effect waves-light btn color  black-text t_sm sin_sombra marg_top" style="border-style: none;">Año</a>
		            <a class="waves-effect waves-light btn color  claro t_sm sin_sombra marg_top" style ="margin-right: -5px; border-color: black; border-width: 1px; border-radius: 5px 0px 0px 5px;">2013</a>
		            <a class="waves-effect waves-light btn color  claro t_sm sin_sombra marg_top" style ="margin-right: -5px; border-color: black; border-width: 1px; border-radius: 0;">2014</a>
		            <a class="waves-effect waves-light btn color  claro t_sm sin_sombra marg_top" style ="margin-right: -5px; border-color: black; border-width: 1px; border-radius: 0px 5px 5px 0px;">2015</a>
	            </div>
            </div>
          </div>
      </div>
    </div>
    <script src="https://npmcdn.com/leaflet@1.0.0-rc.3/dist/leaflet.js"></script>
    <script type="text/javascript" src="entidad.json"></script>
    <script type="text/javascript" src="entidadCompara.json"></script>
    <script type="text/javascript" src="entidad2.json"></script>
    <script type="text/javascript" src="municipio.json"></script>
    <script type="text/javascript" src="nacion.json"></script>

    <!-- Load d3.js and c3.js -->
  <script src="lib/d3.v3.min.js" charset="utf-8"></script>
  <script src="lib/c3.min.js"></script>
  <script src="classybrew/build/classybrew.min.js"></script>
  <script type="text/javascript">
	$(document).ready(function() {



    $('.modal-trigger').leanModal();


    	$('select').material_select();
  	});
    $(document).ready(function(){
      $('.collapsible').collapsible({
        accordion : true
      });

      console.log($('#objetivos').find('li.active').children().children());
    });
    </script>
      <script type="text/javascript">
	  function commaSeparateNumber(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return parts.join(".");}


		  var chart2 = c3.generate({
			bindto: '#chart2',
		    data: {
		        x: 'x',
		        columns: [
		            ['x', '2009-01-01', '2010-01-01', '2011-01-01', '2012-01-01', '2013-01-01'],
		           ['Aguascalientes',      '122.24', '104.54',    '120.4',       '122.8',       '110.4'],
['Baja California  ',   '93.05',  '108.39',    '92.3',        '86.6',        '86.8'],
['Baja California Sur', '54.22',  '53.06',     '57',          '64.8',        '68.6'],
['Campeche',            '4.76',   '4.78',      '6.6',         '5.8',         '4.5'],
['Chiapas',             '15.8',   '20.36',     '16.6',        '18.9',        '18.5'],
['Chihuahua',           '64.18',  '68.05',     '68.1',        '72.8',        '74.4'],
['Coahuila',            '46.07',  '48.3',      '45.1',        '46.4',        '45.2'],
['Colima',              '43.64',  '51',        '51.7',        '52.1',        '59.6'],
['Distrito Federal',    '14.22',  '14.82',     '14.8',        '13.9',        '13.6'],
['Durango',             '57.85',  '59.15',     '61.8',        '65',          '60.6'],
['Guanajuato',          '46.08',  '45.38',     '46.6',        '50.2',        '59'],
['Guerrero',            '47.93',  '60.49',     '56.4',        '57.6',        '74.2'],
['Hidalgo',             '9.66',   '12',        '12',          '6.8',         '5.4'],
['Jalisco',             '23.37',  '25.75',     '35.5',        '46.3',        '51.9'],
['MÃ©xico',             '20.04',  '23.64',     '24.8',        '28',          '28.4'],
['Michoacán',           '26.06',  '26.59',     '26.4',        '27.3',        '32.1'],
['Morelos',             '18.82',  '18.79',     '25.4',        '26.4',        '23.5'],
['Nayarit',             '65.34',  '72.86',     '72.9',        '83.4',        '104.1'],
['Nuevo León ',         '118.42', '112.14',    '108.3',       '109.5',       '117.2'],
['Oaxaca',              '27.4',   '28.18',     '27.6',        '28.4',        '33.3'],
['Puebla',              '35.49',  '36.59',     '46.1',        '43',          '53.9'],
['Querétaro',           '22.65',  '41.51',     '41.3',        '42.3',        '45.5'],
['Quintana Roo ',       '60.49',  '57.37',     '61.5',        '55.6',        '55.6'],
['San Luis Potosí',     '47.74',  '48.66',     '47.7',        '49.1',        '53.2'],
['Sinaloa',             '61.82',  '66.08',     '68.8',        '71.6',        '68'],
['Sonora',              '31.65',  '31.76',     '32',          '34.9',        '34.6'],
['Tabasco',             '18.31',  '19.93',     '19.9',        '20.7',        '25.3'],
['Tamaulipas',          '53.87',  '59.85',     '73.4',        '75.6',        '71.8'],
['Tlaxcala',            '53.49',  '54.42',     '49.1',        '48.4',        '43.1'],
['Veracruz',            '25.73',  '28.14',     '32.7',        '34.9',        '39.6'],
['Yucatán',             '1.63',   '2.65',      '2.1',         '2.1',         '2.6'],
['Zacatecas',           '13.79',  '18.81',     '21.4',        '23.1',        '35.5'],
['Promedio nacional',            '42.0565625',  '44.50125',     '45.821875',        '47.321875',        '50']
		        ]
		    },
		    legend: {
				show: false
				},
			padding: {
		        left: 40,
		        right: 30
		    },
		    point: {
			  show: true
			},
			color: {
		        pattern:['#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#ccc','#f00']
		    },

		    axis : {
		        x : {
		            type : 'timeseries',
		            tick: {
		                format: function (x) { return x.getFullYear(); }
		              //format: '%Y' // format string is also available for timeseries data
		            }
		        }
		    },tooltip: {
		        grouped: false, // Default true
		        	format: {
		            title: function (d) { return d.name; },
		            value: function (value, ratio, id) {
			            (function ($) {
				            if (id != "Promedio nacional") {
					      $( "svg g.c3-chart-line g.c3-circles circle" ).css('fill','#ccc');
								$( "svg g.c3-chart-line path.c3-line" ).css('stroke','#ccc');
								$( "svg g.c3-chart-line g.c3-circles-Promedio-nacional circle" ).css('fill','#f00');
								$( "svg g.c3-chart-line path.c3-line-Promedio-nacional" ).css('stroke','#f00');
								$( "svg g.c3-chart-line g.c3-circles-" +id.replace(/ /g,'-') + " circle" ).css('fill','#00aeef');
								$( "svg g.c3-chart-line path.c3-line-" +id.replace(/ /g,'-') ).css('stroke','#00aeef');
				            }
				            else {
					            $( "svg g.c3-chart-line g.c3-circles circle" ).css('fill','#ccc');
								$( "svg g.c3-chart-line path.c3-line" ).css('stroke','#ccc');
					            $( "svg g.c3-chart-line g.c3-circles-Promedio-nacional circle" ).css('fill','#f00');
								$( "svg g.c3-chart-line path.c3-line-Promedio-nacional" ).css('stroke','#f00');
				            }
			            }(jQuery));
		                return commaSeparateNumber(Math.round(value*10)/10);
		            }
		//            value: d3.format(',') // apply this format to both y and y2
		        }
		    },
		});
  </script>



  <script>
	function gen(props)
	{
	  // var chart = c3.generate({
		// 		bindto: '.info',
		// 		padding: {
		// 			top: 10,
		// 	        left: 30,
		// 	        right: 10
		// 	    },
		// 	    data: {
		// 	        x: 'x',
		// 			columns: [
	  //           ['x', '2009-01-01', '2010-01-01', '2011-01-01', '2012-01-01', '2013-01-01'],
	  //           props
		//         ]
    //
    //
		// 	    },
		// 	    axis: {
		// 	        x: {
		// 	            type: 'timeseries',
		// 	            tick: {
		//                		 format: function (x) { return x.getFullYear(); }
		// 	            }
		// 	        },
		// 	        y : {
		// 	            tick: {
		// 	                format: d3.format(".2s")
		// 	            }
		// 	        }
		// 	    },
		// 	    color: {
		// 	        pattern: ['#00AEEF']
		// 	    },
		// 	    size: {
		// 	        width: 260,
		// 	        height: 160
		// 	    },
		// 	    legend: {
		// 	        show: false
		// 	    },
		// 	    grid: {
		// 	        x: {
		// 	            show: false
		// 	        },
		// 	        y: {
		// 	            show: true
		// 	        }
		// 	    }
    //
		// });
	}
  </script>


    <script type="text/javascript">
var estados =[
['x', '2009-01-01', '2010-01-01', '2011-01-01', '2012-01-01', '2013-01-01'],
['Aguascalientes',      '122.24', '104.54',    '120.4',       '122.8',       '110.4'],
['Baja California  ',   '93.05',  '108.39',    '92.3',        '86.6',        '86.8'],
['Baja California Sur', '54.22',  '53.06',     '57',          '64.8',        '68.6'],
['Campeche',            '4.76',   '4.78',      '6.6',         '5.8',         '4.5'],
['Chiapas',             '15.8',   '20.36',     '16.6',        '18.9',        '18.5'],
['Chihuahua',           '64.18',  '68.05',     '68.1',        '72.8',        '74.4'],
['Coahuila',            '46.07',  '48.3',      '45.1',        '46.4',        '45.2'],
['Colima',              '43.64',  '51',        '51.7',        '52.1',        '59.6'],
['Distrito Federal',    '14.22',  '14.82',     '14.8',        '13.9',        '13.6'],
['Durango',             '57.85',  '59.15',     '61.8',        '65',          '60.6'],
['Guanajuato',          '46.08',  '45.38',     '46.6',        '50.2',        '59'],
['Guerrero',            '47.93',  '60.49',     '56.4',        '57.6',        '74.2'],
['Hidalgo',             '9.66',   '12',        '12',          '6.8',         '5.4'],
['Jalisco',             '23.37',  '25.75',     '35.5',        '46.3',        '51.9'],
['MÃ©xico',             '20.04',  '23.64',     '24.8',        '28',          '28.4'],
['Michoacán',           '26.06',  '26.59',     '26.4',        '27.3',        '32.1'],
['Morelos',             '18.82',  '18.79',     '25.4',        '26.4',        '23.5'],
['Nayarit',             '65.34',  '72.86',     '72.9',        '83.4',        '104.1'],
['Nuevo León ',         '118.42', '112.14',    '108.3',       '109.5',       '117.2'],
['Oaxaca',              '27.4',   '28.18',     '27.6',        '28.4',        '33.3'],
['Puebla',              '35.49',  '36.59',     '46.1',        '43',          '53.9'],
['Querétaro',           '22.65',  '41.51',     '41.3',        '42.3',        '45.5'],
['Quintana Roo ',       '60.49',  '57.37',     '61.5',        '55.6',        '55.6'],
['San Luis Potosí',     '47.74',  '48.66',     '47.7',        '49.1',        '53.2'],
['Sinaloa',             '61.82',  '66.08',     '68.8',        '71.6',        '68'],
['Sonora',              '31.65',  '31.76',     '32',          '34.9',        '34.6'],
['Tabasco',             '18.31',  '19.93',     '19.9',        '20.7',        '25.3'],
['Tamaulipas',          '53.87',  '59.85',     '73.4',        '75.6',        '71.8'],
['Tlaxcala',            '53.49',  '54.42',     '49.1',        '48.4',        '43.1'],
['Veracruz',            '25.73',  '28.14',     '32.7',        '34.9',        '39.6'],
['Yucatán',             '1.63',   '2.65',      '2.1',         '2.1',         '2.6'],
['Zacatecas',           '13.79',  '18.81',     '21.4',        '23.1',        '35.5'],
];

    //variable de mapa
      var img;
      var data_url;
      var locked=false;
      var map = L.map('map' ,
      {
	        scrollWheelZoom: false,
	        maxZoom: 14,
			minZomm:5,
			//zoomControl:false,
			//dragging: false
      }).setView([24.8, -100], 5);

    //implementacion de mapa estandar y ubicacion haci como zoom
 //     L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {
	 	L.tileLayer('http://{s}.google.com/vt/?hl=es&x={x}&y={y}&z={z}&s={s}&apistyle=s.t%3A5|p.l%3A53%2Cs.t%3A1314|p.v%3Aoff%2Cp.s%3A-100%2Cs.t%3A3|p.v%3Aon%2Cs.t%3A2|p.v%3Aoff%2Cs.t%3A4|p.v%3Aoff%2Cs.t%3A3|s.e%3Ag.f|p.w%3A1|p.l%3A100%2Cs.t%3A18|p.v%3Aoff%2Cs.t%3A49|s.e%3Ag.s|p.v%3Aon|p.s%3A-19|p.l%3A24%2Cs.t%3A50|s.e%3Ag.s|p.v%3Aon|p.l%3A15&style=47,37', {
		subdomains:['mt0', 'mt1', 'mt2', 'mt3'],
        maxZoom: 14,
        minZomm:5,
        attribution: '',
        id: 'mapbox.light',
      }).addTo(map);

      if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) )
      {
			map.dragging.disable();
	  }



      // control that shows state info on hover
      var info = L.control();
      info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'infos hide');
        this.update();
        return this._div;
      };




      info.update = function (props) {
	     //this._div = L.DomUtil.create('div', 'infos');
	     $('.infos').removeClass('hide');
	     $('.info2').removeClass('hide');
	     if(props != undefined)
	     {
		      this._div.innerHTML='<div class="infoPadre" ><h5 style="font-weight:bold">' + props.nom_ent + '</h5>'+
                                ' <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b style="font-size: 20px;color: #00aeef;">' + props.density + '</b></p>' +
                                ' <p style="position: absolute; top: 25%; left: 35%;">Porcentaje de aguas<br>residuales tratadas</p></div>'+
                                ' <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b style="font-size: 20px;color: #D500F9;">' + props.rezago + '</b></p>' +
                                '</b></p><p style="position: absolute; top: 55%; left: 35%;">Proporción de la población con rezago educativo (2012)</p></div>';

			  gen(estados[props.cve]);
	     }
/*
        this._div.innerHTML = '<div><h4>Aguas tratadas</h4>' +  (props ?
          '<b>' + props.nom_ent + '</b><br />' + props.density + '% avance</div>'
          : 'Situate sobre un estado')+'<div class="info"></div>';
          if(props != undefined)
		  {

		  }
*/
      };
      info.addTo(map);
      // get color depending on population density value
      // function getColor(d) {
      // 	return d > 1000 ? '#800026' :
      // 	       d > 500  ? '#BD0026' :
      // 	       d > 200  ? '#E31A1C' :
      // 	       d > 100  ? '#FC4E2A' :
      // 	       d > 50   ? '#FD8D3C' :
      // 	       d > 20   ? '#FEB24C' :
      // 	       d > 10   ? '#FED976' :
      // 	                  '#FFEDA0';
      // }

      function getColor(d) {
        return d > 100 ? '#004b67' :
               d > 50  ? '#007dab' :
               d > 20  ? '#01baff' :
                         '#45ccff';
      }

      function getColoR(number)
      {
	    return brew.getColorInRange(number);
	  }

      function style(feature) {
	    var res=String(getColoR(feature.properties.density)).split(",");
	    //console.log("hola->",res[1]);
        return {
          weight: 0.5,
          opacity: 1,
          color: '#000',
          dashArray: '1',
          fillOpacity: 0.6,
          fillColor: getColoR(feature.properties.density),
           className: "c"+res[1]
        };
      }
      function highlightFeature(e) {
	     if(locked == false)
	     {
	        var layer = e.target;
	        layer.setStyle({
	          weight: 2,
	          color: '#ccc',
	          dashArray: '',
	          fillOpacity: 0.7
	        });
	        if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
	          layer.bringToFront();
	        }
	        info.update(layer.feature.properties);
	     }
      }
      var geojson;
      function resetHighlight(e) {
/*
	     if(locked == false)
	     {
*/
		     geojson.resetStyle(e.target);
			 info.update();
// 	 	 }
      }
      function zoomToFeature(e) {
        map.fitBounds(e.target.getBounds());
      }
      function onEachFeature(feature, layer) {
        layer.on({
          mouseover: highlightFeature,
          mouseout: resetHighlight,
          mousedown: function(e)
          {
			if (locked == true) {
				locked = false;
				(function ($) {
								 $(".info2").css("border","none");
								 $(".infos").css("border","none");
							   }(jQuery));
			}
			else {
				locked = true;
				(function ($) {
							//	$(".info2").css("border","5px solid #00cc99");
								$(".info2").css("border-bottom","5px solid rgb(107, 174, 214)");
								$(".info2").css("border-left","5px solid rgb(107, 174, 214)");
								$(".info2").css("border-right","5px solid rgb(107, 174, 214)");
								$(".infos").css("border-top","5px solid rgb(107, 174, 214)");
								$(".infos").css("border-left","5px solid rgb(107, 174, 214)");
								$(".infos").css("border-right","5px solid rgb(107, 174, 214)");
//								$(".infos").css("border","5px solid #00cc99");
							   }(jQuery));
			}
// 			resetHighlight(e);
		 },
//          click: zoomToFeature
        });
      }

      function highlightFromLegend(e)
      	{
	      	//console.log(e);
			(function ($) {
				$("svg path."+e).addClass("highlighted");
				var r=$("svg path."+e);
				for(var i=0;i<r.length;i++)
				{
					r[i].classList.add("highlighted");
					//console.log(r[i]);
				}
				//console.log($("svg path."+e));
			}(jQuery));
		}

		function clearHighlight() {
			(function ($) {

				$("path").removeClass("highlighted");
				var r=$("path");
				for(var i=0;i<r.length;i++)
				{
					r[i].classList.remove("highlighted");
				}
				//console.log(r);
			}(jQuery));
		}


		var brew = new classyBrew();
		var values = [];
		for (var i = 0; i < statesData.features.length; i++){
			if (statesData.features[i].properties.density == null) continue;
			values.push(statesData.features[i].properties.density);
		}
		brew.setSeries(values);
		brew.setNumClasses(4);
		brew.setColorCode("Blues");
		brew.classify('jenks');
/*
      geojson = L.geoJson(statesData, {
        style: style,
        onEachFeature: onEachFeature
      }).addTo(map);
*/

/*
	  geojson = L.geoJson(municipio, {
        style: style,
        onEachFeature: onEachFeature
      }).addTo(map);

	  geojson = L.geoJson(entidad, {
        style: style,
        onEachFeature: onEachFeature
      }).addTo(map);
*/

      geojson = L.geoJson(statesData, {
        style: style,
        onEachFeature: onEachFeature
      }).addTo(map);

/*
      geojson = L.geoJson(nacion, {
        style: style,
        onEachFeature: onEachFeature
      }).addTo(map);
*/

      map.attributionControl.addAttribution('');
      var legend = L.control();
      legend.onAdd = function (map) {
        var div = L.DomUtil.create('div', 'info2 legend hide'),
          grades = brew.getBreaks(),//[0, 20, 50, 100],
          labels = [],
          from, to;
        for (var i = 0; i < grades.length-1; i++) {
          from = grades[i];
          to = grades[i + 1];
          var res=String(getColoR(from + 1)).split(",");
          //console.log(res[1]);
          labels.push(
            '<div style="float:left; text-align: center;"><i class="leyenda" onmouseover="highlightFromLegend(\'c'+ res[1] +'\')" onmouseout="clearHighlight();" style="width:100%; background:' + getColoR(from + 1) + '"></i><br>' +
            from + (to ? '&ndash;' + to : '+')+'</div>');
        }
        div.innerHTML = labels.join('');
        return div;
      };
      legend.addTo(map);
    </script>
    <script>
        $(document).ready(function() {
            $('.tooltip').tooltipster({
				contentCloning: true,
				animation: 'fade',
				delay: 200,
				theme: 'tooltipster-light',
				trigger: 'hover'
      });


        });
    </script>

  </body>
</html>
